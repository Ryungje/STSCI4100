---
title: "Shiny App Interface"
author: "jrc447"
date: "2024-04-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library("shiny")
library("ggplot2")
library("bslib")
library("DT")


# Import movie data

load("movies.RData")
load("simple_movies.RData")
```


```{r}
# Plotting functions for use in Server Controls

plotDistributor = function(plotthis) {
  ## Plotting top 10 Movie Distributors
  
    # sort top Distributors
  temp <- tail(sort(table(movies$Distributor), decreasing=FALSE), n=10)
  temp <- data.frame(temp)
  names(temp) <- c("Distributor", "Movies_Released")
  
    # plot box plot
  ggplot(data=temp, aes(Distributor, Movies_Released)) + geom_col() + coord_flip()
}


plotBasic = function(plotthis){
  simple_movies
}


```


```{r}
# Shiny App 


# Shiny App UI
ui <- page_navbar(
  title = "Top Grossing Movies of 2023",
  inverse = TRUE,
  
    # Interactive panels 
  navset_card_underline(
    nav_panel("Basic Movie Information", 
              tabPanel("", DTOutput("basic")
                       ),
              ),
    nav_panel("Top Distributors", plotOutput("dist")),
    ),
  
  nav_spacer(),
  
  nav_menu(
    title = "Links",
    align = "right",
      # Links to source data
    nav_item(tags$a("2023 Domestic Box Office", href = "https://www.boxofficemojo.com/year/2023/?ref_=bo_yl_table_2")),
    nav_item(tags$a("Supplemental Data", href = "https://www.the-numbers.com/market/2023/top-grossing-movies"))
  ),
  nav_menu(
    title = "Authors",
    align = "right",
    nav_item("James Chun"),
    nav_item("Ilona Khimey"), 
    nav_item("Andrew Zhang")
  ),
  fluid=TRUE
)


server <- function(input, output) {
  ## Shiny App Server Controls

  output$basic <- renderDT(
    plotBasic(input$thisvar)
  )

  output$dist <- renderPlot(
    plotDistributor(input$thisvar)
  )
  
  
}

shinyApp(ui, server)


```



```{r}
# Scratch Code


# Average Running Time
#mean(unique(movies$Running_Time))

```










